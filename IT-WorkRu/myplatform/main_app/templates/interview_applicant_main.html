<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>IT-WorkRu - –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤</title>
    {% load static %}
    <link rel="icon" href="{% static 'favicon.ico' %}" type="image/png">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <style>

        html, body {
            scroll-behavior: smooth;
            margin: 0;
            padding: 0;
            overflow-x: hidden; /* –£–±–∏—Ä–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
        }
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }
        header {
            background-color: #fff;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            width: 100%; /* –†–∞—Å—Ç—è–≥–∏–≤–∞–µ–º —à–∞–ø–∫—É –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É */
            box-sizing: border-box;
        }
        header a {
            text-decoration: none;
            color: #000;
            margin-right: 35px;
            font-weight: bold;
        }
        header a:hover {
            color: #0056b3;
        }
        .login-btn {
            font-weight: bold;
            background-color: #0056b3;
            color: #fff;
            padding: 10px 23px;
            border-radius: 12px;
            text-decoration: none;
        }
        .login-btn:hover {
            background-color: #003f8c;
            color: white;
        }
        .main-content {
            position: relative;
            text-align: center;
            min-height: 100vh; /* –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç, —á—Ç–æ main-content –∑–∞–Ω–∏–º–∞–µ—Ç –º–∏–Ω–∏–º—É–º 100% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞ */
            padding: 20px;
        }
        .main-content h1 {
            font-size: 32px;
            color: #333;
        }
        .main-content p {
            font-size: 18px;
            color: #333;
        }
        .search-box {
            margin-top: 45px;
            display: flex;
            align-items: center;
            border: 2px solid #DCDCDC; /* –ì—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –≤—Å–µ–≥–æ –±–ª–æ–∫–∞ */
            border-radius: 5px; /* –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤ –≤—Å–µ–≥–æ –±–ª–æ–∫–∞ */

        }

        .search-box input[type="text"] {
            padding-top: 17.5px; padding-bottom: 17.5px; padding-left: 23px;
            width: 400px; /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã */
            font-size: 16px;
            border: none; /* –£–±–∏—Ä–∞–µ–º –≥—Ä–∞–Ω–∏—Ü—É —É input */
            flex-grow: 1; /* –î–∞–µ—Ç input –∑–∞–Ω–∏–º–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ */
        }

        .search-box button {
            padding: 19px 20px;
            background-color: #0056b3;
            color: white;
            border: none;
            cursor: pointer;
        }

        .search-box button:hover {
            background-color: #003f8c;
        }
        .search-box input[type="text"]:focus {
        outline: none; /* –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–æ—é —Ä–∞–º–∫—É –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ */
        }
        footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            text-align: center;
            padding: 20px;
            background-color: #333;
            font-size: 14px;
            color: #f0f0f0;
        }
/* –î–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ */
.dropdown {
    position: relative;
    display: inline-block;
}

/* –°–∫—Ä—ã—Ç—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ */
.dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 250px;
    box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
    z-index: 1;
    top: 240%; /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ */
    text-align: left;
}

/* –ü—Å–µ–≤–¥–æ—ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±—É—Ñ–µ—Ä–Ω–æ–π –∑–æ–Ω—ã */
.dropdown::after {
    content: '';
    display: block;
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    height: 46px; /* –í—ã—Å–æ—Ç–∞ –±—É—Ñ–µ—Ä–Ω–æ–π –∑–æ–Ω—ã */
    background: transparent;
    z-index: 0;
}

/* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
.dropdown:hover .dropdown-content {
    display: block;
}

/* –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –≤–Ω—É—Ç—Ä–∏ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ */
.dropdown-content a {
    display: block;
    padding: 12px 16px; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø—ã –≤–Ω—É—Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
    width: 100%; /* –°—Å—ã–ª–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Å—é —à–∏—Ä–∏–Ω—É */
    box-sizing: border-box; /* –í–∫–ª—é—á–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã –∏ –≥—Ä–∞–Ω–∏—Ü—ã –≤ —Ä–∞–∑–º–µ—Ä—ã —ç–ª–µ–º–µ–Ω—Ç–∞ */
    color: black;
    text-decoration: none;
}

/* –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ —Å—Å—ã–ª–∫—É –∏–∑–º–µ–Ω—è–µ—Ç—Å—è —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ –ø–æ –≤—Å–µ–π —à–∏—Ä–∏–Ω–µ */
.dropdown-content a:hover {
    background-color: #f0f0f0; /* –ë–æ–ª–µ–µ —Å–≤–µ—Ç–ª—ã–π —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ */
    border: none; /* –£–±–∏—Ä–∞–µ–º –≥—Ä–∞–Ω–∏—Ü—ã */
    color: #0056b3; /* –ò–∑–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º –∏ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª–∞—Ö */
.main-content img:first-of-type {
    position: absolute;
    top: -20px;
    left: 0px;
    width: 280px; /* –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ */
    height: auto;
}
.main-content img:last-of-type {
    position: absolute;
    bottom: 140px;
    right: 0px;
    width: 550px; /* –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ */
    height: auto;
}
           .container {max-width: 1200px;
width: 100%;
margin: 0 auto;

display: flex;
align-items: center;
justify-content: space-between;
}
    </style>
</head>
<body>

<header style="border-bottom: 4px solid #0056b3; display: flex; align-items: center; justify-content: space-between; padding: 10px 20px;">
    <div class="container">
    <div>
        <style>  .no-select {
        user-select: none; /* –ó–∞–ø—Ä–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ */
        -webkit-user-select: none; /* –î–ª—è WebKit-–±—Ä–∞—É–∑–µ—Ä–æ–≤ */
        -moz-user-select: none; /* –î–ª—è Firefox */
        -ms-user-select: none; /* –î–ª—è —Å—Ç–∞—Ä—ã—Ö IE */
    } </style>
        <a class="no-select" href="../" style="font-family: Arial, sans-serif; font-size: 24px; font-weight: 800; color: #0056b3; text-decoration: none;">
            IT-Work<span style="color: #FD494C;">Ru</span>
        </a>
    </div>
        {% if not user.is_authenticated %}
    <div style="display: flex; gap: 20px; align-items: center;">

        <div class="dropdown">
            <a href="#" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è–º</a>
            <div class="dropdown-content">
                <a href="../finder">–ù–∞–π—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</a>
                <a href="../page_vacancy">–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é</a>
                <a href="../register_employer">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
            </div>
        </div>
        <div class="dropdown">
            <a href="#" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–°–æ–∏—Å–∫–∞—Ç–µ–ª—è–º</a>
            <div class="dropdown-content">
                <a href="../finder">–ù–∞–π—Ç–∏ —Ä–∞–±–æ—Ç—É</a>
                <a href="../page_resume">–°–æ–∑–¥–∞—Ç—å —Ä–µ–∑—é–º–µ</a>
                <a href="../register_applicant">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
            </div>
        </div>
        <div class="dropdown">
            <a href="../blog" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ë–ª–æ–≥</a>
        </div>
        {% else %}

        {% if user.role == "applicant" %}
 <div style="display: flex; gap: 20px; align-items: right;">
                <div class="dropdown">
            <a href="../finder" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ù–∞–π—Ç–∏ —Ä–∞–±–æ—Ç—É</a>
        </div>
                <div class="dropdown">
            <a href="../blog" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ë–ª–æ–≥</a>
        </div>
                <div class="dropdown">
            <a href="../page_resume" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–°–æ–∑–¥–∞—Ç—å —Ä–µ–∑—é–º–µ</a>
        </div>

     </div>
        {% else %}

 <div style="display: flex; gap: 20px; align-items: right;">
                <div class="dropdown">
            <a href="../finder" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ù–∞–π—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</a>
        </div>
        <div class="dropdown">
            <a href="../blog" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ë–ª–æ–≥</a>
        </div>
                <div class="dropdown">
            <a href="../page_vacancy" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é</a>
        </div>

</div>





        {% endif %}


         {% endif %}
        {% if user.is_authenticated %}
        <div class="dropdown" id="dropdown-important" style="display: flex; flex-direction: row;">

        <img style="width: 38px; border-radius: 50%;" src="{% static 'profile.png' %}" alt="profile">
        <div style="margin-left: 15px; text-align: left;">


            <span style="color: #2A3137; font-size: 18px; font-family: Arial; font-weight: 700; word-wrap: break-word; display: block;">
                {{ user.first_name }} {{ user.last_name }}
            </span>
            <span style="color: #A1A1A1; font-size: 16px; font-family: Arial; font-weight: 400; word-wrap: break-word; display: block;">
                {{ user.email }}
            </span>


        </div>

        <img class="rotating-image_1"
     style="cursor: pointer; margin-top: 10px; margin-left: 16px; width: 13px; height: 20px; transform: rotate(-180deg); transition: transform 0.3s ease;"
     src="{% static 'Down.png' %}"
     alt="Down" />
                   <div class="dropdown-content" style="margin-top: -40px; min-width: 300px; top: 240%;">
                        {% if user.role == "applicant" %}
                        <a href="../featured_jobs" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;"><img style="width: 23px; border-radius: 80%; margin-left: -3px; margin-bottom: -4px; padding-right: 7px;" src="{% static 'love_vacancies.png' %}" alt="love_vacancies">–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏ (0)</a>
                        <a href="../person_notifications" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (0)</a>
                        <a href="../person_account#my_resumes" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ú–æ–∏ —Ä–µ–∑—é–º–µ (0)</a>
                       <a href="../person_account" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
                       <a href="../person_account/#employers_responses" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–û—Ç–∫–ª–∏–∫–∏ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–µ–π (0)</a>
                        <a href="../page_person" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</a>
                       <a href="../page_person/#change_password_applicant" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</a>
                       <a href="../person_account/#current_balance_applicant" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: 0 —Ä—É–±.</a>
                       <a href="../payment_person_history" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π</a>
                       <a href="../person_account?action=openPopup_person" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å</a>
                       {% else %}
                        <a href="../company_notifications" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (0)</a>
                        <a href="../company_account#my_vacancies" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–í–∞–∫–∞–Ω—Å–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏ (0)</a>
                        <a href="../company_account" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
                       <a href="../company_account#applicants_responses" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–û—Ç–∫–ª–∏–∫–∏ —Å–æ–∏—Å–∫–∞—Ç–µ–ª–µ–π (0)</a>
                        <a href="../page_company" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</a>
                       <a href="../page_company#change_password_employer" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</a>
                       <a href="../company_account#current_balance_employer" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: 0 —Ä—É–±.</a>
                       <a href="../payment_company_history" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π</a>
                       <a href="../company_account?action=openPopup_company" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å</a>
                       {% endif %}
<a href="#" onclick="logout()" style="display: flex; align-items: center;">
    <img style="width: 23px; border-radius: 80%;  margin-left: -3px; margin-top: -2px; padding-right: 7px;" src="{% static 'exit_image_1.png' %}" alt="exit_image">
    <span style=" font-family: Arial, sans-serif; font-size: 16px;">–í—ã–π—Ç–∏</span>
</a>


            </div>

        </div>
        {% else %}
        <a href="../login" class="login-btn" style="font-family: Arial, sans-serif; font-size: 16px; text-decoration: none;">–í–æ–π—Ç–∏</a>
        {% endif %}




    </div></div>
</header>
<script>
// –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ ID
const dropdownContainer = document.getElementById('dropdown-important');

// –ü–æ–ª—É—á–∞–µ–º —Å—Ç—Ä–µ–ª–∫—É
const rotatingImage = dropdownContainer.querySelector('.rotating-image_1');

// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –Ω–∞ –≤–µ—Å—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
dropdownContainer.addEventListener('mouseover', () => {
    rotatingImage.style.transform = 'rotate(0deg)'; // –ü–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Å—Ç—Ä–µ–ª–∫—É –≤–≤–µ—Ä—Ö
});

dropdownContainer.addEventListener('mouseout', () => {
    rotatingImage.style.transform = 'rotate(-180deg)'; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç—Ä–µ–ª–∫—É –≤–Ω–∏–∑
});



    function logout() {
        fetch('{% url "logout" %}', {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}'
            },
            credentials: 'same-origin'
        })
        .then(response => {
            if (response.ok) {
                // –ï—Å–ª–∏ –≤—ã—Ö–æ–¥ —É—Å–ø–µ—à–µ–Ω, –æ–±–Ω–æ–≤–∏—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
                location.reload();  // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            }
        })
        .catch(error => console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ:', error));
    }
</script>

<style>

    :root {
	--c-black: #000000;
	--c-dark: #202020;
	--c-white: #ffffff;
	--c-light: #eeeeee;
	--c-gray: #bbbbbb;
	--c-cyan: #afc4e4;
	--c-blue: #0056b3;
	--c-red: #FD494C;

	--fz-s: 14px;
	--fz-m: 16px;
	--fz-l: 18px;
	--fz-xl: 24px;
	--fz-xxl: 36px;
}

/* interview */

button {
	background-color: transparent;
	border: none;
	margin: 0;
	padding: 0;
}

.interview {
	background-color: rgba(19, 56, 108, 1);
	padding: 87.5px 0 107.5px;
	color: var(--c-white);
	text-align: center;
}

.interview__title {
	font-size: var(--fz-xxl);
	font-weight: 700;
	margin: 0 auto 50px;
	text-align: center;
}

.interview__title-button {
	background-color: var(--c-white);
	padding: 0px 5px;
	margin: 0 auto 15px;
	border-radius: 0.5rem;
	border-radius: 3px solid rgba(29, 85, 166, 1);
}

.interview__wrapper {
	display: flex;
	justify-content: center;
	gap: 10px;
}
.interview__box {
	max-width: 500px;
	background: rgb(29, 85, 166);
	background: linear-gradient(
		45deg,
		rgba(29, 85, 166, 0.14) 0%,
		rgba(29, 85, 166, 0.29) 50%,
		rgba(29, 85, 166, 0.5) 100%
	);
	border-radius: 1rem;
	box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.3);
}
.interview__image-box {
	width: 100%;
	aspect-ratio: 1 / 1;
	overflow: hidden;
	border-radius: 1rem 1rem 0 0;
	border: 1px solid var(--c-white);
}
.interview__image {
	width: 100%;
	height: 100%;
	object-fit: cover;
	object-position: center center;
}
.interview__name {
	font-size: var(--fz-xl);
	font-weight: 900;
	margin: 20px auto 5px;
}
.interview__status {
	font-size: var(--fz-s);
	color: rgba(215, 215, 215, 1);
	margin-bottom: 25px;
}
.interview__items {
}
.interview__item {
	margin-bottom: 20px;
}
.interview__item-button {
	color: var(--c-white);
	font-size: var(--fz-m);
	font-weight: 900;
	background-color: rgba(29, 85, 166, 1);
	width: 85%;
	padding: 12px;
	border-radius: 0.75rem;
}
.interview__repeat {
	font-weight: 700;
	font-size: var(--fz-s);
	display: block;
	background-color: var(--c-white);
	padding: 5px 15px;
	margin: 0 auto 15px;
	border-radius: 0.5rem;
	border-radius: 3px solid rgba(29, 85, 166, 1);
}
.interview__text {
	font-weight: 700;
	font-size: var(--fz-s);
	color: rgba(215, 215, 215, 1);
}

.interview__content {
	padding: 30px;
}
.interview__svg-box {
	display: flex;
	justify-content: space-between;
}
.interview__svg {
}
.interview__microphone-box {
	max-width: 250px;
	aspect-ratio: 1 / 1;
	margin: 0 auto 10px;
	background-color: #0b2140;
	display: flex;
	align-items: center;
	justify-content: center;
	border-radius: 100%;
}
.interview__microphone-button {
	display: inline-block;
	position: relative;
	width: 80%;
	aspect-ratio: 1 / 1;
	border-radius: 100%;
	background: rgb(29, 85, 166);
	background: linear-gradient(
		30deg,
		rgba(29, 85, 166, 1) 0%,
		rgba(138, 79, 122, 1) 50%,
		rgba(253, 73, 76, 1) 100%
	);
}
.interview__microphone-button::before {
	content: '';
	width: 125%;
	aspect-ratio: 1 / 1;
	background-color: rgba(29, 85, 166, 0.32);
	border-radius: 100%;
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
}

.interview__microphone-button::after {
	content: '';
	width: 112.5%;
	aspect-ratio: 1 / 1;
	background-color: rgba(138, 79, 122, 0.32);
	border-radius: 100%;
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	border: 1px solid #8a4f7a;
}
.interview__microphone-image {
	position: absolute;
	z-index: 100;
	display: block;
	background-size: cover;
	background-repeat: no-repeat;
	background-position: center center;
	background-image: url("{% static 'microphon.svg' %}");
	width: 97px;
	height: 119.5px;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
}

.blue {
	color: var(--c-blue);
}
.red {
	color: var(--c-red);
}

                   .main_content {

    min-height: 100vh; /* –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç, —á—Ç–æ main-content –∑–∞–Ω–∏–º–∞–µ—Ç –º–∏–Ω–∏–º—É–º 100% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞ */
   max-width:  1220px;
            width: 100%;
            margin: 0 auto;
            padding: 10px;
        }
</style>
                   <style>
    .interview__status {
        font-size: var(--fz-s);
        color: #d7d7d7;
        display: flex;
        flex-direction: row; /* –í –û–î–ù–£ –°–¢–†–û–ö–£ */
        align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≤—ã—Å–æ—Ç–µ */
        justify-content: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ */
        gap: 0.5rem; /* –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∞–Ω–∏–º–∞—Ü–∏–µ–π –∏ —Ç–µ–∫—Å—Ç–æ–º */
    }

    .speaking-indicator {
        display: flex;
        align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
        gap: 4px;
        height: 15px; /* –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–µ–º –≤—ã—Å–æ—Ç—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
    }

    .speaking-indicator span {
        display: block;
        width: 4px;
        height: 6px;
        background-color: var(--c-white);
        border-radius: 10rem;
        transform-origin: bottom; /* –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–µ–º —Ç–æ—á–∫—É –≤—Ä–∞—â–µ–Ω–∏—è –≤–Ω–∏–∑—É */
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è "–≥–æ–≤–æ—Ä–∏—Ç" */
    @keyframes speaking {
        0%, 100% {
            height: 6px;
            /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
        }
        50% {
            height: 15px;
            /* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
        }
    }

    /* –ü—Ä–∏–º–µ–Ω—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º */
    .speaking-indicator span {
        animation: speaking 0.7s infinite ease-in-out;
    }

    .speaking-indicator.speaking span:nth-child(1) {
        animation-delay: 0s;
    }
    .speaking-indicator.speaking span:nth-child(2) {
        animation-delay: 0.1s;
    }
    .speaking-indicator.speaking span:nth-child(3) {
        animation-delay: 0.2s;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è "–¥—É–º–∞–µ—Ç" */
    @keyframes thinking {
        0%, 100% { opacity: 0.2; transform: scaleY(0.8); }
        50% { opacity: 1; transform: scaleY(1.2); }
    }

    .speaking-indicator.thinking span {
        animation: thinking 1.5s infinite ease-in-out;
    }

    .speaking-indicator.thinking span:nth-child(1) {
        animation-delay: 0s;
    }
    .speaking-indicator.thinking span:nth-child(2) {
        animation-delay: 0.2s;
    }
    .speaking-indicator.thinking span:nth-child(3) {
        animation-delay: 0.4s;
    }

    .speaking-text {
        white-space: nowrap; /* –ß—Ç–æ–±—ã —Ç–µ–∫—Å—Ç –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏–ª—Å—è */
        display: inline-block; /* –ë–ª–æ–∫ –ø–æ —Å—Ç—Ä–æ–∫–µ */
        font-weight: bold;
        margin-left: 8px; /* –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∞–Ω–∏–º–∞—Ü–∏–µ–π –∏ —Ç–µ–∫—Å—Ç–æ–º */
    }

    .speaking-indicator.thinking + .speaking-text {

    }

                       .speaking-indicator {
  display: none; /* –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç–æ */
}

.speaking-indicator.speaking,
.speaking-indicator.thinking {
  display: flex; /* –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö */
}
</style>








<style>
  /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ø–∞–ø–∞ */
  .popup__wrapper {display: flex;
    z-index: 999;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    justify-content: center;
    align-items: center;
    opacity: 0; /* –ù–∞—á–∞–ª—å–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å */
    transition: opacity 0.5s ease; /* –ü–ª–∞–≤–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –ø–æ—è–≤–ª–µ–Ω–∏—è */
  }

  .popup {
    background-color: white;
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    max-width: 400px;
    width: 100%;
  }

.form__password-button {
  margin-bottom: 15px;
  padding: 10px 30px;
}

.btn {
  font-size: var(--fz-m);
  font-weight: 700;
  background-color: var(--c-blue);
  color: var(--c-white);
  border-radius: 0.5rem;
  border: 1px solid var(--c-blue);
  cursor: pointer;
  transition: all 0.3s ease 0s;
  text-align: center;
}
.btn:hover {
  background-color: var(--c-white);
  color: var(--c-blue);
}
</style>

<div class="interview">
  <div class="container_1">
    <h1 class="interview__title">
      –°–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ —Å
      <span class="interview__title-button"
        ><span class="blue">AI</span><span class="red">Ru</span></span
      >
      –Ω–∞ –ø–æ–∑–∏—Ü–∏—é | {{ vacancy.title }}

    </h1>
    <div class="interview__wrapper">
      <div class="interview__box">

<!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ–¥–Ω–æ –≤–∏–¥–µ–æ (–¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞) -->
<div class="interview__image-box">
  {% if questions %}
    <div class="video-wrapper">
      <video id="currentVideo" class="interview__video" width="100%" controls poster="{% static 'default_speaker_start.png' %}">
        <source src="{{ questions.0.video.url }}" type="video/webm">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç video.
      </video>
    </div>
  {% endif %}
</div>

        <div class="interview__name">
            {% if interview.hr_name %}
    {{ interview.hr_name }}
{% elif interview.gender == '–ú–£–ñ' %}
    –î–º–∏—Ç—Ä–∏–π
{% elif interview.gender == '–ñ–ï–ù' %}
    –ê–Ω–∞—Å—Ç–∞—Å–∏—è
{% endif %}
        </div>
        <!--<div class="interview__status">–≥–æ–≤–æ—Ä–∏—Ç</div>-->

          									<div class="interview__status">
  <div class="speaking-indicator">
    <span></span>
    <span></span>
    <span></span>
  </div>
  <div class="speaking-text">–≥–æ–≤–æ—Ä–∏—Ç</div>
</div>


        <div class="interview__items">
          <!--<div class="interview__item">
            <button class="interview__item-button">
              –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –∫–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?
            </button>
          </div>
          <div class="interview__item">
            <button class="interview__item-button">
              –†–∞–¥–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –í–∞—Å –Ω–∞
            </button>
          </div>
          <div class="interview__item">
            <button class="interview__item-button">
              —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏! –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ
            </button>
          </div>-->
<div class="interview__items" id="interview-questions-runner">
  <div class="interview__item-line interview__item-line--1">
    <button class="interview__item-button" id="runner-line-1"></button>
  </div><br>
  <div class="interview__item-line interview__item-line--2">
    <button class="interview__item-button" id="runner-line-2"></button>
  </div><br>
  <div class="interview__item-line interview__item-line--3">
    <button class="interview__item-button" id="runner-line-3"></button>
  </div>
</div>

{% if questions.exists %}
<script>
  const fullText = `{{ questions.0.text|escapejs }}`;
</script>
{% endif %}

<!--<script>
document.addEventListener('DOMContentLoaded', function () {
  if (typeof fullText === 'undefined' || !fullText.trim()) return;

  const lines = splitTextIntoLines(fullText, 6);
  const lineElements = [
    document.getElementById("runner-line-1"),
    document.getElementById("runner-line-2"),
    document.getElementById("runner-line-3")
  ];

  let currentIndex = 0;
  const delay = 4500; // –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É —Å–º–µ–Ω–æ–π –∫–∞–¥—Ä–æ–≤
  let isCarouselRunning = true; // –§–ª–∞–≥ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏

  function updateLines() {
    if (!isCarouselRunning) return; // –ï—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ ‚Äî –≤—ã—Ö–æ–¥–∏–º

    for (let i = 0; i < lineElements.length; i++) {
      const index = (currentIndex + i) % lines.length;
      lineElements[i].textContent = lines[index] || "";
    }

    currentIndex = (currentIndex + 1) % lines.length;
    setTimeout(updateLines, delay);
  }

  updateLines(); // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é

  // ==== –ù–æ–≤—ã–π –∫–æ–¥: –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞—Ä—É—Å–µ–ª—å –ø—Ä–∏ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –≤–∏–¥–µ–æ ====
  const videoPlayer = document.getElementById("currentVideo");

  if (videoPlayer) {
    videoPlayer.addEventListener("ended", () => {
      console.log("–í–∏–¥–µ–æ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å ‚Äî –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞—Ä—É—Å–µ–ª—å");
      isCarouselRunning = false; // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
    });
  }
});

function splitTextIntoLines(text, maxLines = 6) {
  const words = text.trim().split(/\s+/);
  const chunkSize = Math.ceil(words.length / maxLines);
  const result = [];

  for (let i = 0; i < words.length; i += chunkSize) {
    result.push(words.slice(i, i + chunkSize).join(" "));
  }

  while (result.length < maxLines) result.push("");

  return result;
}
</script>-->
<script>
  const lineElements = [
    document.getElementById("runner-line-1"),
    document.getElementById("runner-line-2"),
    document.getElementById("runner-line-3")
  ];

  const delay = 4500;
  let isCarouselRunning = true;
  let currentQuestion = "";
  let carouselTimeoutId = null;

  // ==== –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–∑–±–∏–≤–∫–∏ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —Å—Ç—Ä–æ–∫–∏ ====
  function splitTextIntoLines(text, maxLines = 6) {
    const words = text.trim().split(/\s+/);
    if (!words.length) return [];

    const chunkSize = Math.ceil(words.length / maxLines);
    const result = [];
    for (let i = 0; i < words.length; i += chunkSize) {
      result.push(words.slice(i, i + chunkSize).join(" "));
    }

    return result;
  }

  // ==== –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—É—Å–µ–ª–∏ ====
  function updateCarousel(questionText, useMaxLines = 6) {
    // –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö ‚Äî –≤—ã—Ö–æ–¥–∏–º
    if (!questionText || questionText === "–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤") {
      clearCarousel();
      return;
    }

    const lines = splitTextIntoLines(questionText, useMaxLines);

    for (let i = 0; i < lineElements.length; i++) {
      lineElements[i].textContent = lines[i] || "";
    }

    animateCarousel(lines);
  }

  // ==== –ê–Ω–∏–º–∞—Ü–∏—è –∫–∞—Ä—É—Å–µ–ª–∏ ====
  function animateCarousel(lines) {
    if (carouselTimeoutId) clearTimeout(carouselTimeoutId);

    let index = 0;

    function nextLine() {
      for (let i = 0; i < lineElements.length; i++) {
        const pos = (index + i) % lines.length;
        lineElements[i].textContent = lines[pos] || "";
      }
      index = (index + 1) % lines.length;

      if (isCarouselRunning) {
        carouselTimeoutId = setTimeout(nextLine, delay);
      }
    }

    nextLine();
  }

  // ==== –û—á–∏—Å—Ç–∫–∞ –∫–∞—Ä—É—Å–µ–ª–∏ ====
  function clearCarousel() {
    lineElements.forEach(el => el.textContent = "");
    if (carouselTimeoutId) clearTimeout(carouselTimeoutId);
  }

  // ==== –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –∏–∑ FastAPI ====
  async function fetchCurrentQuestion(sessionId) {
    try {
      const response = await fetch(`http://localhost:8101/current_question/${sessionId}`);
      if (!response.ok) throw new Error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö");

      const data = await response.json();
      let question = data.question;

        // === –£–î–ê–õ–ï–ù–ò–ï –í–ù–ï–®–ù–ò–• –ö–ê–í–´–ß–ï–ö ===
        if (question && (question.startsWith('¬´') && question.endsWith('¬ª'))) {
          question = question.slice(1, -1);
        }

      if (question === "–ò–Ω—Ç–µ—Ä–≤—å—é –∑–∞–≤–µ—Ä—à–µ–Ω–æ") {
        isCarouselRunning = false;
        return;
      }

      if (question === "–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤" || !question.trim()) {
        if (typeof fullText !== 'undefined' && fullText.trim()) {
          if (currentQuestion !== fullText) {
            currentQuestion = fullText;
            updateCarousel(fullText, 6); // –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ 6 —Å—Ç—Ä–æ–∫
          }
        } else {
          clearCarousel();
        }
        return;
      }

      if (question && question !== currentQuestion) {
        currentQuestion = question;
        updateCarousel(question, 3); // –í–æ–ø—Ä–æ—Å—ã –æ—Ç API ‚Äî –Ω–∞ 3 —Å—Ç—Ä–æ–∫–∏
      }
    } catch (error) {
      console.error("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≤–æ–ø—Ä–æ—Å:", error);
    }
  }

  // ==== –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –æ–ø—Ä–æ—Å API ====
  async function pollCurrentQuestion(sessionId) {
    while (isCarouselRunning) {
      await fetchCurrentQuestion(sessionId);
      await new Promise(resolve => setTimeout(resolve, 2000));
    }
  }

  // ==== –õ–æ–≥–∏–∫–∞ —Å—Ç–∞—Ä—Ç–∞ –∏–Ω—Ç–µ—Ä–≤—å—é ====
  document.addEventListener('DOMContentLoaded', function () {
    const startInterviewButton = document.getElementById("startInterviewButton");
    const videoPlayer = document.getElementById("currentVideo");

    // ====== –°–ö–†–´–í–ê–ï–ú –¢–ï–ö–°–¢ –î–û –ù–ê–ß–ê–õ–ê –ò–ù–¢–ï–†–í–¨–Æ ======
    // –û—á–∏—â–∞–µ–º –∫–∞—Ä—É—Å–µ–ª—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    clearCarousel();

    // ====== –ö–ù–û–ü–ö–ê "–ù–ê–ß–ê–¢–¨ –ò–ù–¢–ï–†–í–¨–Æ" ======
    if (startInterviewButton) {
      startInterviewButton.addEventListener("click", () => {
        // –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞—á–∏–Ω–∞–µ–º –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å –∏–∑ –ë–î
        if (typeof fullText !== 'undefined' && fullText.trim()) {
          currentQuestion = fullText;
          updateCarousel(fullText, 6); // –¢–æ–ª—å–∫–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ 6 —Å—Ç—Ä–æ–∫
        }
      });
    }

    // ====== –ó–ê–ü–£–°–ö –û–ü–†–û–°–ê API –ü–û–°–õ–ï –°–û–ó–î–ê–ù–ò–Ø session_id ======
    const checkSessionAndStartPolling = setInterval(() => {
      const sessionId = localStorage.getItem("session_id");
      if (sessionId) {
        clearInterval(checkSessionAndStartPolling);
        pollCurrentQuestion(sessionId); // –¢–µ–ø–µ—Ä—å –æ–ø—Ä–∞—à–∏–≤–∞–µ–º API
      }
    }, 1000);
  });
</script>

            <br><br>
            <div class="interview__text">–°–æ–∑–¥–∞–Ω–æ –ø—Ä–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ </div>
               <img  style="width: 15%;  margin-top: 7px; " src="{% static 'logo_ecosystem.png' %}" alt="logo_ecosystem" />

        </div>
        <!--<button class="interview__repeat" style="margin-top: 50px;">
          <span class="blue">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å</span> <span class="red"> –≤–æ–ø—Ä–æ—Å </span>
        </button>-->
        <!--<button class="interview__text">–°–º–µ–Ω–∏—Ç—å —Å–ø–∏–∫–µ—Ä–∞ –Ω–∞ –î–º–∏—Ç—Ä–∏—è</button>-->
      </div>

      <div class="interview__box">
        <div class="interview__image-box">
    <video id="video" class="interview__image" autoplay poster="{% static 'default_speaker_start.png' %}"></video>
        </div>
          <script>
    // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç video
    const video = document.getElementById('video');

    // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –≤–µ–±-–∫–∞–º–µ—Ä–µ
    navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => {
            video.srcObject = stream;
        })
        .catch(error => {
            console.error("–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ:", error);
        });
</script>
        <div class="interview__content">
          <div class="interview__svg-box">
  <button id="cameraButton">
    <div class="icon-wrapper">
      <img class="interview__svg" id="cameraIcon" src="{% static 'camera.svg' %}" alt="Camera" />
    </div>
  </button>
  <button id="soundButton">
    <div class="icon-wrapper">
      <img class="interview__svg" id="soundIcon" src="{% static 'sound.svg' %}" alt="Sound" />
    </div>
  </button>
</div>
          <div class="interview__microphone-box">
<!-- –ö–Ω–æ–ø–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ -->
<button id="microphoneButton" class="interview__microphone-button" style="cursor: pointer;">
  <img src="{% static 'microphon.svg' %}" alt=""/>
  <span class="interview__microphone-image"></span>
</button>
          </div>
          <p class="interview__text">
            –ù–∞–∂–º–∏—Ç–µ, –∫–æ–≥–¥–∞ <br />
            –∑–∞–∫–æ–Ω—á–∏—Ç–µ –æ—Ç–≤–µ—á–∞—Ç—å
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
    /* === –ê–Ω–∏–º–∞—Ü–∏—è –º–∏–≥–∞–Ω–∏—è –≤–æ–∫—Ä—É–≥ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ === */
.microphone-blink {
    position: absolute;
    top: 71.31%;
    left: 60%;
    transform: translate(-50%, -50%);
    width: 230px; /* —á—É—Ç—å –±–æ–ª—å—à–µ –∫–Ω–æ–ø–∫–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ */
    height: 230px;
    border: 4px solid #900020;
    border-radius: 50%;
    animation: blink-ring 1.2s infinite ease-in-out;
    pointer-events: none;
    z-index: 9999;
}

@keyframes blink-ring {
    0% { opacity: 0.6; transform: translate(-50%, -50%) scale(1); }
    50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
    100% { opacity: 0.6; transform: translate(-50%, -50%) scale(1); }
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function () {
    // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç .interview__microphone-box
    const microphoneBox = document.querySelector(".interview__microphone-box");
    const micButton = document.getElementById("microphoneButton");
    const videoPlayer = document.getElementById("currentVideo");

    let blinkElement = null;

    // –§—É–Ω–∫—Ü–∏—è: –ø–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é
    function showMicrophoneBlink() {
        if (!blinkElement) {
            blinkElement = document.createElement("div");
            blinkElement.classList.add("microphone-blink");
            microphoneBox.appendChild(blinkElement);
        }
    }

    // –§—É–Ω–∫—Ü–∏—è: —Å–∫—Ä—ã—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é
    function hideMicrophoneBlink() {
        if (blinkElement) {
            blinkElement.remove();
            blinkElement = null;
        }
    }

    // ==== –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤–∏–¥–µ–æ ====
    videoPlayer.addEventListener("ended", () => {
        console.log("–í–∏–¥–µ–æ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é...");
        showMicrophoneBlink(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–∏–≥–∞–Ω–∏–µ
    });

    // ==== –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω ====
    micButton.addEventListener("click", () => {
        console.log("–ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–∞–∂–∞—Ç ‚Äî —É–±–∏—Ä–∞–µ–º –º–∏–≥–∞–Ω–∏–µ...");
        hideMicrophoneBlink(); // –°–∫—Ä—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
    });
});
</script>
<style>.icon-wrapper {
  position: relative;
  display: inline-block;
}

.icon-wrapper::after {
  content: '';
  position: absolute;
  top: 50%;
  left: -10%; /* –°–º–µ—â–∞–µ–º –ª–∏–Ω–∏—é –Ω–µ–º–Ω–æ–≥–æ –≤–ª–µ–≤–æ */
  width: 120%; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É –ª–∏–Ω–∏–∏ */
  height: 3px; /* –¢–æ–ª—â–∏–Ω–∞ –ª–∏–Ω–∏–∏ */
  background-color: red;
  transform: rotate(-45deg);
  transform-origin: center;
  opacity: 0; /* –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç–æ */
  transition: opacity 0.3s ease;
}

.icon-wrapper.crossed::after {
  opacity: 1; /* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–µ—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ */
}</style>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const cameraButton = document.getElementById('cameraButton');
  const soundButton = document.getElementById('soundButton');
  const cameraIconWrapper = document.querySelector('#cameraIcon').closest('.icon-wrapper');
  const soundIconWrapper = document.querySelector('#soundIcon').closest('.icon-wrapper');
  const videoElement = document.getElementById('video');
  const currentVideo = document.getElementById('currentVideo'); // –≠–ª–µ–º–µ–Ω—Ç –≤–∏–¥–µ–æ, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å

  let isCameraOn = true; // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞–º–µ—Ä—ã
  let isSoundOn = true; // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–≤—É–∫–∞
  let mediaStream = null; // –•—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–∏–π –º–µ–¥–∏–∞–ø–æ—Ç–æ–∫

  // –õ–æ–≥–∏–∫–∞ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∫–∞–º–µ—Ä—ã
  cameraButton.addEventListener('click', async () => {
    isCameraOn = !isCameraOn; // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    cameraIconWrapper.classList.toggle('crossed', !isCameraOn); // –î–æ–±–∞–≤–ª—è–µ–º/—É–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å

    if (isCameraOn) {
      console.log('–ö–∞–º–µ—Ä–∞ –≤–∫–ª—é—á–µ–Ω–∞');
      startCamera(); // –í–∫–ª—é—á–∞–µ–º –∑–∞–ø–∏—Å—å —Å –∫–∞–º–µ—Ä—ã
    } else {
      console.log('–ö–∞–º–µ—Ä–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞');
      stopAllMedia(); // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –º–µ–¥–∏–∞–ø–æ—Ç–æ–∫–∏
      videoElement.srcObject = null; // –û—Ç–∫–ª—é—á–∞–µ–º –ø–æ—Ç–æ–∫ –æ—Ç –≤–∏–¥–µ–æ—ç–ª–µ–º–µ–Ω—Ç–∞
    }
  });

  // –õ–æ–≥–∏–∫–∞ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∑–≤—É–∫–∞
  soundButton.addEventListener('click', async () => {
    isSoundOn = !isSoundOn; // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    soundIconWrapper.classList.toggle('crossed', !isSoundOn); // –î–æ–±–∞–≤–ª—è–µ–º/—É–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å

    if (isSoundOn) {
      console.log('–ó–≤—É–∫ –≤–∫–ª—é—á–µ–Ω');
      currentVideo.muted = false; // –í–∫–ª—é—á–∞–µ–º –∑–≤—É–∫ –¥–ª—è –≤–∏–¥–µ–æ
    } else {
      console.log('–ó–≤—É–∫ –≤—ã–∫–ª—é—á–µ–Ω');
      currentVideo.muted = true; // –í—ã–∫–ª—é—á–∞–µ–º –∑–≤—É–∫ –¥–ª—è –≤–∏–¥–µ–æ
    }
  });

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã
  async function startCamera() {
    try {
      mediaStream = await navigator.mediaDevices.getUserMedia({ video: true });
      console.log('–ó–∞–ø–∏—Å—å —Å –∫–∞–º–µ—Ä—ã –Ω–∞—á–∞—Ç–∞');
      videoElement.srcObject = mediaStream; // –ü–æ–¥–∫–ª—é—á–∞–µ–º –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ –∫ —ç–ª–µ–º–µ–Ω—Ç—É <video>
    } catch (err) {
      console.error('–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ:', err);
    }
  }

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∑–≤—É–∫–∞
  async function startAudio() {
    try {
      mediaStream = await navigator.mediaDevices.getUserMedia({ audio: true });
      console.log('–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –Ω–∞—á–∞—Ç–æ');
      // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞—É–¥–∏–æ–ø–æ—Ç–æ–∫–æ–º
    } catch (err) {
      console.error('–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É:', err);
    }
  }

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –º–µ–¥–∏–∞–ø–æ—Ç–æ–∫–æ–≤
  function stopAllMedia() {
    if (mediaStream) {
      const tracks = mediaStream.getTracks();
      tracks.forEach(track => {
        track.stop(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞–∂–¥—ã–π —Ç—Ä–µ–∫
        console.log(`–¢—Ä–µ–∫ ${track.kind} –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω`);
      });
      mediaStream = null; // –û—á–∏—â–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –ø–æ—Ç–æ–∫
    }
  }
});
</script>

<!-- –ü–æ–ø–∞–ø –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –∏–Ω—Ç–µ—Ä–≤—å—é -->
<div class="popup__wrapper" id="popupWrapper_interview">
  <div class="popup">
    <h2>–ù–∞—á–∞—Ç—å —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ</h2>
            <b>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –ø–æ–∫–∏–¥–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ –µ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏,
      –∏–Ω–∞—á–µ –≤–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—é!</b><br><br>
                  <p>–ù–∞–∂–∏–º–∞—è –∫–Ω–æ–ø–∫—É ¬´–ù–∞—á–∞—Ç—å —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ¬ª, –≤—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ —Å–≤–æ–µ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ IT-WorkRu –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞–ø–∏—Å–∏ –≤–∞—à–∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è –∞—É–¥–∏–æ- –∏ –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å–∏, –∞ —Ç–∞–∫–∂–µ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –∞–Ω–∞–ª–∏–∑ –≤–∞—à–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–∞—à–µ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞.</p>
                  <p>–í—ã —Ç–∞–∫–∂–µ –¥–∞–µ—Ç–µ —Å–≤–æ–µ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—é –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–ª–Ω–æ–π –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å–∏ –∏–Ω—Ç–µ—Ä–≤—å—é, –≤–∞—à–∏–º —Ç–µ–∫—Å—Ç–æ–≤—ã–º –æ—Ç–≤–µ—Ç–∞–º –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –∞ —Ç–∞–∫–∂–µ –∫ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º –¥–∞–Ω–Ω—ã–º –ø–æ –Ω–∏–º.</p>
<br><br>
    <button id="startInterviewButton" class="form__password-button btn">
      –ù–∞—á–∞—Ç—å —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ
    </button>
  </div>
</div>

<script>
async function fetchAndLogResults(sessionId) {
    try {
        const response = await fetch(`http://localhost:8101/get_results/${sessionId}`);
        if (!response.ok) {
            throw new Error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤");
        }

        const data = await response.json();

        console.log("üìä –ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è:", data.percentage_match);

        if (data.scores_by_skill && Object.keys(data.scores_by_skill).length > 0) {
            console.log("\nüìå –û—Ü–µ–Ω–∫–∏ –ø–æ –Ω–∞–≤—ã–∫–∞–º:");
            for (const [skill, scores] of Object.entries(data.scores_by_skill)) {
                console.log(`üîπ ${skill}: ${scores.reduce((a,b) => a + b, 0)} –±–∞–ª–ª–æ–≤ | –î–µ—Ç–∞–ª–∏: ${scores}`);
            }
        }

        if (data.conversation_log && data.conversation_log.length > 0) {
            console.log("\nüìú –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞:");
            data.conversation_log.forEach(line => console.log(line));
        }

            // üî• –î–æ–±–∞–≤–∏–º –≤—ã–≤–æ–¥ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
        if (data.summary) {
            console.log("\nüìù –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–≤—å—é:");
            console.log(data.summary);

            // –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —ç—Ç–æ –≤ HTML (–µ—Å–ª–∏ —Ö–æ—á–µ—à—å)
            const summaryElement = document.getElementById("interviewSummary");
            if (summaryElement) {
                summaryElement.textContent = data.summary;
            }
        }

        return data;

    } catch (error) {
        console.error("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:", error);
    }
}

async function checkIfInterviewCompleted(sessionId) {
    try {
        const response = await fetch(`http://localhost:8101/get_results/${sessionId}`);
        if (!response.ok) {
            console.warn("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:", response.status);
            return false;
        }

        const data = await response.json();

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ –Ω–∞–≤—ã–∫–∏ –æ—Ü–µ–Ω–µ–Ω—ã (–ø–æ 3 –æ—Ü–µ–Ω–∫–∏ –Ω–∞ –∫–∞–∂–¥—ã–π)
        const allSkillsAnswered = Object.values(data.scores_by_skill).every(
            scores => scores.length >= 3
        );

        if (allSkillsAnswered) {
            console.log("‚úÖ –í—Å–µ –Ω–∞–≤—ã–∫–∏ –æ—Ü–µ–Ω–µ–Ω—ã. –ò–Ω—Ç–µ—Ä–≤—å—é –∑–∞–≤–µ—Ä—à–µ–Ω–æ.");
            fetchAndLogResults(sessionId);

            // --- –î–û–ë–ê–í–õ–ï–ù–û: –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–∞ Django ---
            const percentageMatch = data.percentage_match.replace("%", "").trim(); // "87.20%"
            const conversationLog = data.conversation_log;
            const summary = data.summary || "";

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ Django
            const interviewResponse = await fetch("/api/interview/update-match/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRFToken": getCsrfToken_1(), // –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å CSRF
                },
                body: JSON.stringify({
                    session_id: sessionId,
                    percentage: parseFloat(percentageMatch),
                    conversation_log: conversationLog,
                    summary: summary
                })
            });

            if (interviewResponse.ok) {
                console.log("‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–¥–∞–Ω –≤ Django");
            } else {
                console.error("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–¥–∞—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è");
            }

            return true;
        } else {
            console.log("üïí –ò–Ω—Ç–µ—Ä–≤—å—é –µ—â—ë –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –ñ–¥—ë–º —Å–ª–µ–¥—É—é—â–∏—Ö –æ—Ü–µ–Ω–æ–∫...");
            return false;
        }
    } catch (error) {
        console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤—å—é:", error);
        return false;
    }
}

function getCsrfToken_1() {
    const csrfCookie = document.cookie
        .split("; ")
        .find(row => row.startsWith("csrftoken="));
    return csrfCookie ? csrfCookie.split("=")[1] : null;
}

  const speakingIndicator = document.querySelector('.speaking-indicator');
  const speakingText = document.querySelector('.speaking-text');



  // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã DOM (–æ–±—ä—è–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–¥–∏–Ω —Ä–∞–∑)
  const popupWrapper = document.getElementById("popupWrapper_interview");
  const startInterviewButton = document.getElementById("startInterviewButton");
  const videoPlayer = document.getElementById("currentVideo");
  const micButton = document.getElementById("microphoneButton");

  let mediaRecorder;
  let audioChunks = [];

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
function updateStatus(state) {
  if (state === 'speaking') {
    speakingIndicator.classList.remove('thinking');
    speakingIndicator.classList.add('speaking');
    speakingText.textContent = '–≥–æ–≤–æ—Ä–∏—Ç';
    speakingIndicator.style.display = 'flex'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
  } else if (state === 'thinking') {
    speakingIndicator.classList.remove('speaking');
    speakingIndicator.classList.add('thinking');
    speakingText.textContent = '–¥—É–º–∞–µ—Ç';
    speakingIndicator.style.display = 'flex'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
  } else {
    speakingIndicator.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
    speakingText.textContent = '';
  }
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–∏–¥–µ–æ
function updateVideoStatus() {
  if (videoPlayer.paused || videoPlayer.ended) {
    updateStatus(null); // –°–∫—Ä—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é, –µ—Å–ª–∏ –≤–∏–¥–µ–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
  } else {
    updateStatus('speaking'); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é "–≥–æ–≤–æ—Ä–∏—Ç", –µ—Å–ª–∏ –≤–∏–¥–µ–æ –∏–≥—Ä–∞–µ—Ç
  }
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≤–∏–¥–µ–æ
if (videoPlayer) {
  videoPlayer.addEventListener('play', updateVideoStatus);
  videoPlayer.addEventListener('pause', updateVideoStatus);
  videoPlayer.addEventListener('ended', updateVideoStatus);

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  updateVideoStatus();
}

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ø–∞–ø–∞
  function showPopup() {
    popupWrapper.style.opacity = "1";
    popupWrapper.style.pointerEvents = "auto";
  }

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –ø–æ–ø–∞–ø–∞
  function hidePopup() {
    popupWrapper.style.opacity = "0";
    popupWrapper.style.pointerEvents = "none";
  }

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  window.addEventListener("load", () => {
    showPopup();
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞—á–∞—Ç—å —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ"
  startInterviewButton.addEventListener("click", () => {
    hidePopup(); // –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–ø–∞–ø
    videoPlayer.play(); // –ó–∞–ø—É—Å–∫–∞–µ–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –≤–∏–¥–µ–æ
  });

  // üé¨ –ö–æ–≥–¥–∞ –≤–∏–¥–µ–æ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è, –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–∏—Å—å
  videoPlayer.addEventListener("ended", () => {
    console.log("–í–∏–¥–µ–æ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å ‚Äî –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–∏—Å—å –∞—É–¥–∏–æ...");
    startRecording();
  });

  // üé§ –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –∑–∞–ø–∏—Å–∏
  function startRecording() {
    navigator.mediaDevices.getUserMedia({ audio: true })
      .then(stream => {
        mediaRecorder = new MediaRecorder(stream);
        mediaRecorder.start();

        audioChunks = [];

        mediaRecorder.addEventListener("dataavailable", event => {
          audioChunks.push(event.data);
        });

        console.log("–ó–∞–ø–∏—Å—å –Ω–∞—á–∞–ª–∞—Å—å...");
      })
      .catch(err => {
        console.error("–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É:", err);
      });
  }

  micButton.addEventListener("click", () => {
    if (mediaRecorder && mediaRecorder.state === "recording") {
    updateStatus('thinking');
        mediaRecorder.stop();

        mediaRecorder.addEventListener("stop", () => {
            const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
            const formData = new FormData();
            formData.append("file", audioBlob);

            // –ü–æ–ª—É—á–∞–µ–º session_id –∏–∑ localStorage
            const sessionId = localStorage.getItem("session_id");
            if (sessionId) {
                formData.append("session_id", sessionId);  // –î–æ–±–∞–≤–ª—è–µ–º session_id –≤ –∑–∞–ø—Ä–æ—Å
            } else {
                console.error("session_id –Ω–µ –Ω–∞–π–¥–µ–Ω");
                return;
            }

            fetch("http://localhost:8101/process_audio/", {
            // fetch("https://fussily-phenomenal-shearwater.cloudpub.ru/process_audio/", {
                method: "POST",
                body: formData,
            })
            .then(response => response.blob())  // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç –∫–∞–∫ —Ñ–∞–π–ª
            .then(videoBlob => {
    const videoUrl = URL.createObjectURL(videoBlob);
    videoPlayer.src = videoUrl;
    videoPlayer.load();

    const handleVideoEnd = async () => {
        const sessionId = localStorage.getItem("session_id");
        if (sessionId) {
            await checkIfInterviewCompleted(sessionId);
        } else {
            console.warn("‚ùå Session ID –Ω–µ –Ω–∞–π–¥–µ–Ω.");
        }

        videoPlayer.removeEventListener("ended", handleVideoEnd);
    };

    videoPlayer.addEventListener("ended", handleVideoEnd);
    videoPlayer.play();
    updateStatus('speaking');
})
            .catch(error => {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∞—É–¥–∏–æ:", error);
            });
        });
    }
});


async function sendVideoLink() {
    const videoUrl = "{{ questions.0.video.url }}";
    const gender = "{{ interview.gender }}";  // –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª –∏–∑ —à–∞–±–ª–æ–Ω–∞
    const skills = "{{ vacancy.skills_hidden }}";
    const title = "{{ vacancy.title }}";
    const interviewUniqueLink = "{{ interview.unique_link }}";

    if (!videoUrl) {
        console.error("–í–∏–¥–µ–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.");
        return;
    }

    const data = {
        video_url: videoUrl,
        gender: gender,  // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª
        skills: skills,
        title: title,
        interview_unique_link: interviewUniqueLink
    };

    const res = await fetch("http://localhost:8101/upload_video_link/", {
       // const res = await fetch("https://fussily-phenomenal-shearwater.cloudpub.ru/upload_video_link/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
    });

    if (res.ok) {
        const responseJson = await res.json();  // –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
        const sessionId = responseJson.session_id;  // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç session_id
        console.log("–°–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞, session_id:", sessionId);

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º session_id, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ localStorage –∏–ª–∏ –∫–∞–∫-—Ç–æ –∏–Ω–∞—á–µ
        // localStorage.setItem("session_id", sessionId);
        localStorage.setItem("session_id", interviewUniqueLink);
    } else {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö.");
    }
}



document.addEventListener("DOMContentLoaded", function() {
    document.getElementById("startInterviewButton").addEventListener("click", sendVideoLink);
});




</script>

<!--
{% if questions %}
  <script>
    // –°–æ–±–∏—Ä–∞–µ–º URL –≤—Å–µ—Ö –≤–∏–¥–µ–æ –∏–∑ –≤–æ–ø—Ä–æ—Å–æ–≤
    const videoUrls = [
      {% for question in questions %}
        "{% if question.video %}{{ question.video.url }}{% else %}#{% endif %}"{% if not forloop.last %},{% endif %}
      {% endfor %}
    ];
  </script>
{% else %}
  <script>
    const videoUrls = [];
  </script>
{% endif %}

<input type="hidden" id="questionId" value="{{ questions.0.id }}">

<script>
    function getCSRFToken() {
    return document.querySelector('meta[name="csrf-token"]').getAttribute('content');
}

document.addEventListener('DOMContentLoaded', function () {
    const popup = document.getElementById('popupWrapper_interview');
    const startButton = document.getElementById('startInterviewButton');
    const microphoneButton = document.getElementById('microphoneButton');
    const currentVideo = document.getElementById('currentVideo');

    let currentVideoIndex = 0;
    let mediaRecorder;
    let audioChunks = [];

    setTimeout(() => {
        popup.style.display = 'flex';
        setTimeout(() => { popup.style.opacity = '1'; }, 10);
    }, 500);

    startButton.addEventListener('click', function () {
        popup.style.opacity = '0';
        setTimeout(() => {
            popup.style.display = 'none';
            microphoneButton.style.display = 'inline-block';
        }, 500);

        if (videoUrls.length > 0) {
            currentVideoIndex = 0;
            playVideo(currentVideoIndex);
        }
    });

    microphoneButton.addEventListener('click', function () {
        console.log("–ö–Ω–æ–ø–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –Ω–∞–∂–∞—Ç–∞");

        if (mediaRecorder && mediaRecorder.state !== 'inactive') {
            stopRecording();
        } else {
            console.log("–ó–∞–ø–∏—Å—å –Ω–µ –±—ã–ª–∞ –∞–∫—Ç–∏–≤–Ω–æ–π");
        }

        if (currentVideoIndex < videoUrls.length - 1) {
            currentVideoIndex++;
            playVideo(currentVideoIndex);
        } else {
            console.log("–í—Å–µ –≤–∏–¥–µ–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω—ã");
        }
    });

    function playVideo(index) {
    if (videoUrls[index] && videoUrls[index] !== "#") {
        currentVideo.pause();
        microphoneButton.disabled = true;
        const source = currentVideo.querySelector('source');
        source.src = videoUrls[index];
        currentVideo.load();
        currentVideo.play();

        // üîπ –û–±–Ω–æ–≤–ª—è–µ–º `questionId` –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –Ω–æ–≤–æ–≥–æ –≤–∏–¥–µ–æ
        document.getElementById('questionId').value = questionIds[index - 1] || questionIds[0];

        currentVideo.onended = function () {
            microphoneButton.disabled = false;
            startRecording();
        };
    }
}


    function startRecording() {
        navigator.mediaDevices.getUserMedia({ audio: true })
            .then(stream => {
                mediaRecorder = new MediaRecorder(stream);
                mediaRecorder.ondataavailable = event => {
                    audioChunks.push(event.data);

                    if (audioChunks.length > 0) {
                        sendAudioChunk(audioChunks);
                        audioChunks = [];
                    }
                };

                mediaRecorder.start();
                console.log("–ù–∞—á–∞–ª–∞—Å—å –∑–∞–ø–∏—Å—å –∞—É–¥–∏–æ...");

                mediaRecorder.onstop = () => {
                    if (audioChunks.length > 0) {
                        sendAudioChunk(audioChunks);
                    }
                };
            })
            .catch(error => {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É:", error);
            });
    }

    function sendAudioChunk(audioChunks) {
        const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
        const formData = new FormData();
        formData.append('file', audioBlob, 'audio_response.wav');

        fetch('http://127.0.0.1:8122/transcribe_wav/', {
            method: 'POST',
            headers: { 'X-CSRFToken': getCSRFToken() },
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            console.log('–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', data);
            if (data.transcribed_text) {
                console.log('–¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:', data.transcribed_text);
                sendTextAnswer(data.transcribed_text);
            } else {
                console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏');
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∞—É–¥–∏–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:', error);
        });
    }

    function sendTextAnswer(transcribed_text) {
        const questionId = document.getElementById('questionId').value;  // –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞

        fetch('http://127.0.0.1:8000/save_answer/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCSRFToken()
            },
            body: JSON.stringify({ transcribed_text: transcribed_text, question_id: questionId })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                console.log("–û—Ç–≤–µ—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω.");
            } else {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç–∞:", data.error);
            }
        })
        .catch(error => {
            console.error("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞:", error);
        });
    }

    function stopRecording() {
        if (mediaRecorder && mediaRecorder.state !== 'inactive') {
            mediaRecorder.stop();
            console.log("–ó–∞–ø–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞");
        } else {
            console.log("–ó–∞–ø–∏—Å—å —É–∂–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–ª–∏ –Ω–µ –Ω–∞—á–∞–ª–∞—Å—å");
        }
    }
});

        var questionIds = [{% for question in questions %}{{ question.id }}{% if not forloop.last %}, {% endif %}{% endfor %}];

</script>-->


<!-- ==== –ó–ê–ü–ò–°–¨ –í–ò–î–ï–û –û–¢–í–ï–¢–ê –°–û–ò–°–ö–ê–¢–ï–õ–Ø ==== -->
<script>
    // ==== –£–ù–ò–ö–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï, –ß–¢–û–ë–´ –ù–ï –ö–û–ù–§–õ–ò–ö–¢–û–í–ê–¢–¨ –° –î–†–£–ì–ò–ú JS ====
    let candidateVideoRecorder;
    let videoResponseBlobs = [];

    // ==== –ü–†–û–í–ï–†–Ø–ï–ú –ò–õ–ò –°–û–ó–î–ê–Å–ú videoElement ====
    const videoElement = document.getElementById('video') || document.createElement('video');

    // ==== –û–ë–†–ê–ë–û–¢–ß–ò–ö –°–û–ë–´–¢–ò–ô –î–õ–Ø currentVideo (–ë–ï–ó –î–£–ë–õ–ò–†–û–í–ê–ù–ò–Ø) ====
    const currentVideo = document.getElementById("currentVideo");
    if (currentVideo && !currentVideo._videoResponseHandlerAdded) {
        currentVideo.addEventListener("ended", () => {
            console.log("–í–∏–¥–µ–æ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å ‚Äî –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–∏—Å—å –æ—Ç–≤–µ—Ç–∞...");
            startVideoRecording();
        });
        currentVideo._videoResponseHandlerAdded = true;
    }

    // ==== –û–ë–†–ê–ë–û–¢–ß–ò–ö –°–û–ë–´–¢–ò–ô –î–õ–Ø microphoneButton (–ë–ï–ó –î–£–ë–õ–ò–†–û–í–ê–ù–ò–Ø) ====
    const microphoneButton = document.getElementById("microphoneButton");
    if (microphoneButton && !microphoneButton._videoResponseHandlerAdded) {
        microphoneButton.addEventListener("click", () => {
            console.log("–ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–∞–∂–∞—Ç ‚Äî –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–ø–∏—Å—å –≤–∏–¥–µ–æ...");
            stopAndUploadVideo();
        });
        microphoneButton._videoResponseHandlerAdded = true;
    }

    function startVideoRecording() {
    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
        console.error("‚ùå getUserMedia –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è");
        return;
    }

    // ==== –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –≤–∏–¥–µ–æ (–≤–æ–ø—Ä–æ—Å –æ—Ç AI) ====
    if (currentVideo && !currentVideo.paused) {
        currentVideo.pause();
        console.log("–í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ");
    }

    // ==== –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—É–¥–∏–æ–∑–∞–ø–∏—Å—å, –µ—Å–ª–∏ –æ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞ ====
    if (mediaRecorder && mediaRecorder.state !== 'inactive') {
        mediaRecorder.stop();
        console.log("–ê—É–¥–∏–æ–∑–∞–ø–∏—Å—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞");
    }

    videoResponseBlobs = [];
    navigator.mediaDevices.getUserMedia({ video: true, audio: true })
        .then(stream => {
            candidateVideoRecorder = new MediaRecorder(stream);
            candidateVideoRecorder.ondataavailable = event => {
                if (event.data.size > 0) {
                    videoResponseBlobs.push(event.data);
                }
            };
            candidateVideoRecorder.start();
            console.log("üé• –í–∏–¥–µ–æ –∏ –∞—É–¥–∏–æ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è...");

            if (videoElement) {
                videoElement.srcObject = stream;
                videoElement.muted = true; // ‚ùó –û—Ç–∫–ª—é—á–∞–µ–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞
            }
        })
        .catch(err => {
            console.error("‚ùå –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ/–º–∏–∫—Ä–æ—Ñ–æ–Ω—É:", err);
        });
}

    function stopAndUploadVideo() {
        if (candidateVideoRecorder && candidateVideoRecorder.state !== 'inactive') {
            candidateVideoRecorder.stop();

            candidateVideoRecorder.onstop = () => {
                const videoBlob = new Blob(videoResponseBlobs, { type: 'video/webm' });

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ
                if (videoBlob.size === 0) {
                    console.error("‚ùå –í–∏–¥–µ–æ –Ω–µ –∑–∞–ø–∏—Å–∞–Ω–æ ‚Äî blob –ø—É—Å—Ç–æ–π");
                    return;
                }

                const formData = new FormData();
                formData.append("video_response", videoBlob, "response.webm");

                const questionId = "{{ questions.0.id }}";
                if (!questionId || questionId === "") {
                    console.error("‚ùå ID –≤–æ–ø—Ä–æ—Å–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω");
                    return;
                }
                formData.append("question_id", questionId);

                const csrfToken = getCsrfToken();
                if (!csrfToken) {
                    console.error("‚ùå CSRF —Ç–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω");
                    return;
                }

                fetch("/save_interview_video_response/", {
                    method: "POST",
                    headers: {
                        "X-CSRFToken": csrfToken
                    },
                    body: formData
                })
                .then(response => {
                    if (!response.ok) {
                        console.error("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞:", response.status);
                        return;
                    }
                    return response.json();
                })
                .then(data => {
                    if (data?.success) {
                        console.log("‚úÖ –í–∏–¥–µ–æ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ");
                    } else {
                        console.error("‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:", data?.message || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞");
                    }
                })
                .catch(error => {
                    console.error("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–∏–¥–µ–æ:", error);
                });

                if (videoElement && videoElement.srcObject) {
                    const stream = videoElement.srcObject;


                }
            };
        }
    }

    function getCsrfToken() {
        const csrfCookie = document.cookie
            .split('; ')
            .find(row => row.startsWith('csrftoken='));
        const token = csrfCookie ? csrfCookie.split('=')[1] : null;
        if (!token) {
            console.error("‚ùå CSRF —Ç–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω");
        }
        return token;
    }
</script>





<footer>
    &copy; 2024 IT-WorkRu. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
</footer>

</body>
</html>
